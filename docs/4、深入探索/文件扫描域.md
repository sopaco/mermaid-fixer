# **æ–‡ä»¶æ‰«æåŸŸæŠ€æœ¯æ–‡æ¡£**

---

## **1. æ¦‚è¿°**

**æ–‡ä»¶æ‰«æåŸŸ**ï¼ˆFile Scanning Domainï¼‰æ˜¯ `mermaid-fixer` å·¥å…·é“¾ä¸­çš„**å‰ç½®æ•°æ®é‡‡é›†æ¨¡å—**ï¼Œè´Ÿè´£é€’å½’éå†æŒ‡å®šç›®å½•ï¼Œè¯†åˆ«å¹¶æ”¶é›†æ‰€æœ‰ç¬¦åˆè§„èŒƒçš„ Markdown æ–‡ä»¶è·¯å¾„ï¼ˆ`.md` å’Œ `.markdown`ï¼‰ï¼Œä¸ºåç»­çš„è¯­æ³•éªŒè¯ä¸ AI ä¿®å¤æµç¨‹æä¾›å‡†ç¡®ã€å®Œæ•´çš„è¾“å…¥æºã€‚

è¯¥æ¨¡å—æ˜¯æ•´ä¸ªè‡ªåŠ¨åŒ–æ–‡æ¡£ä¿®å¤æµç¨‹çš„**èµ·ç‚¹**ï¼Œå…¶ç¨³å®šæ€§ã€æ•ˆç‡ä¸å‡†ç¡®æ€§ç›´æ¥å†³å®šäº†åç»­å¤„ç†çš„å®Œæ•´æ€§ã€‚ä½œä¸ºæ— çŠ¶æ€ã€çº¯å‡½æ•°å¼çš„å·¥å…·ç»„ä»¶ï¼Œå®ƒä¸å‚ä¸ä¸šåŠ¡é€»è¾‘å†³ç­–ï¼Œä»…ä¸“æ³¨äº**é«˜æ•ˆã€å¯é åœ°æšä¸¾ç›®æ ‡æ–‡ä»¶é›†åˆ**ï¼Œä¸¥æ ¼éµå¾ªâ€œ**èŒè´£å•ä¸€ã€ä¾èµ–æœ€å°ã€å¯ç§»æ¤æ€§å¼º**â€çš„è®¾è®¡åŸåˆ™ã€‚

---

## **2. æ ¸å¿ƒèŒè´£**

| èŒè´£ | è¯´æ˜ |
|------|------|
| **ç›®å½•é€’å½’æ‰«æ** | ä»ç”¨æˆ·æŒ‡å®šçš„æ ¹è·¯å¾„å‡ºå‘ï¼Œæ·±åº¦éå†å­ç›®å½•æ ‘ï¼Œç¡®ä¿ä¸é—æ¼ä»»ä½•åµŒå¥—å±‚çº§ä¸­çš„ Markdown æ–‡ä»¶ã€‚ |
| **æ–‡ä»¶ç±»å‹è¿‡æ»¤** | ä»…ä¿ç•™æ‰©å±•åä¸º `.md` æˆ– `.markdown` çš„æ–‡ä»¶ï¼Œå¿½ç•¥å…¶ä»–ç±»å‹ï¼ˆå¦‚ `.txt`, `.json`, `.png` ç­‰ï¼‰ã€‚ |
| **ç›®å½•è·³è¿‡æœºåˆ¶** | è‡ªåŠ¨è·³è¿‡ç³»ç»Ÿçº§æˆ–æ„å»ºç”Ÿæˆçš„ç›®å½•ï¼ˆå¦‚ `.git`, `node_modules`, `target`, `dist`, `build`ï¼‰ï¼Œé¿å…æ— æ•ˆéå†ä¸æ€§èƒ½æµªè´¹ã€‚ |
| **è·¯å¾„æ ‡å‡†åŒ–è¾“å‡º** | è¿”å›ç»Ÿä¸€çš„ `Vec<PathBuf>` ç±»å‹ç»“æœï¼Œç¡®ä¿åç»­æ¨¡å—å¯ç›´æ¥ä½¿ç”¨ Rust æ ‡å‡†åº“è¿›è¡Œæ–‡ä»¶è¯»å–ä¸æ“ä½œã€‚ |
| **é”™è¯¯å®‰å…¨å°è£…** | æ‰€æœ‰ I/O æ“ä½œå‡é€šè¿‡ `Result<T, E>` ç±»å‹è¿”å›ï¼Œå¼‚å¸¸ï¼ˆå¦‚æƒé™ä¸è¶³ã€è·¯å¾„ä¸å­˜åœ¨ï¼‰è¢«å°è£…ä¸ºå¯ä¼ é€’çš„é”™è¯¯å¯¹è±¡ï¼Œä¸ä¸­æ–­ä¸»æµç¨‹ã€‚ |

> âœ… **è®¾è®¡å“²å­¦**ï¼š  
> â€œ**ä¸å†³ç­–ï¼Œåªå‘ç°**â€ â€”â€” æ–‡ä»¶æ‰«æåŸŸä¸åˆ¤æ–­æ–‡ä»¶å†…å®¹æ˜¯å¦æœ‰æ•ˆï¼Œä¸è§£æè¯­æ³•ï¼Œä¸ç¼“å­˜ç»“æœï¼Œä»…å®Œæˆâ€œå“ªäº›æ–‡ä»¶éœ€è¦è¢«å¤„ç†â€çš„åŸºç¡€æšä¸¾ä»»åŠ¡ã€‚

---

## **3. æŠ€æœ¯å®ç°ç»†èŠ‚**

### **3.1 æ ¸å¿ƒå®ç°æ–‡ä»¶**
- `src/markdown_scanner.rs`

### **3.2 ä¾èµ–å…³ç³»**
| ç±»å‹ | ä¾èµ–é¡¹ | è¯´æ˜ |
|------|--------|------|
| **æ ‡å‡†åº“** | `std::fs`, `std::path` | æ ¸å¿ƒæ–‡ä»¶ç³»ç»Ÿæ“ä½œä¸è·¯å¾„å¤„ç†ï¼Œæ— ç¬¬ä¸‰æ–¹ä¾èµ– |
| **å¤–éƒ¨ä¾èµ–** | æ—  | å®Œå…¨åŸºäº Rust æ ‡å‡†åº“å®ç°ï¼Œç¡®ä¿é›¶è¿è¡Œæ—¶å¼€é”€ä¸è·¨å¹³å°å…¼å®¹æ€§ |
| **è¢«ä¾èµ–æ¨¡å—** | `å¤„ç†åè°ƒåŸŸ` (`processor.rs`) | ä¸»åŠ¨è°ƒç”¨ `scan_directory()` è·å–æ–‡ä»¶åˆ—è¡¨ |

### **3.3 æ ¸å¿ƒç»“æ„ä¸æ–¹æ³•**

```rust
pub struct MarkdownScanner;

impl MarkdownScanner {
    /// ä¸»å…¥å£æ–¹æ³•ï¼šæ‰«ææŒ‡å®šç›®å½•ï¼Œè¿”å›æ‰€æœ‰åŒ¹é…çš„ Markdown æ–‡ä»¶è·¯å¾„
    pub fn scan_directory<P: AsRef<Path>>(dir: P) -> Result<Vec<PathBuf>, Box<dyn Error>> {
        let dir_path = dir.as_ref();
        if !dir_path.is_dir() {
            return Err(format!("è·¯å¾„ä¸æ˜¯ç›®å½•: {:?}", dir_path).into());
        }

        let mut files = Vec::new();
        Self::scan_recursive(dir_path, &mut files)?;
        Ok(files)
    }

    // ç§æœ‰é€’å½’æ‰«æå‡½æ•°
    fn scan_recursive(dir: &Path, files: &mut Vec<PathBuf>) -> Result<(), Box<dyn Error>> {
        for entry in fs::read_dir(dir)? {
            let entry = entry?;
            let path = entry.path();

            if path.is_dir() {
                if let Some(name) = path.file_name().and_then(|n| n.to_str()) {
                    if Self::should_skip_directory(name) {
                        continue; // è·³è¿‡é»‘åå•ç›®å½•
                    }
                }
                Self::scan_recursive(&path, files)?; // é€’å½’è¿›å…¥å­ç›®å½•
            } else if path.is_file() {
                if Self::is_markdown_file(&path) {
                    files.push(path); // æ”¶é›†æœ‰æ•ˆæ–‡ä»¶
                }
            }
        }
        Ok(())
    }

    // åˆ¤æ–­æ˜¯å¦ä¸º Markdown æ–‡ä»¶ï¼ˆæ‰©å±•ååŒ¹é…ï¼‰
    fn is_markdown_file(path: &Path) -> bool {
        path.extension()
            .and_then(|ext| ext.to_str())
            .map(|ext| ext.eq_ignore_ascii_case("md") || ext.eq_ignore_ascii_case("markdown"))
            .unwrap_or(false)
    }

    // åˆ¤æ–­æ˜¯å¦ä¸ºåº”è·³è¿‡çš„ç›®å½•ï¼ˆé»‘åå•æœºåˆ¶ï¼‰
    fn should_skip_directory(name: &str) -> bool {
        matches!(name.to_lowercase().as_str(),
            ".git" | "node_modules" | "target" | "dist" | "build" | ".idea" | ".vscode" | "out"
        )
    }
}
```

### **3.4 å…³é”®è®¾è®¡ç‰¹æ€§**

| ç‰¹æ€§ | å®ç°æ–¹å¼ | ä»·å€¼ |
|------|----------|------|
| **æ— çŠ¶æ€è®¾è®¡** | `MarkdownScanner` ä¸ºç»“æ„ä½“ï¼Œæ— æˆå‘˜å­—æ®µï¼Œæ‰€æœ‰çŠ¶æ€é€šè¿‡å‚æ•°ä¼ é€’ | æ”¯æŒå¹¶å‘è°ƒç”¨ã€å¯æµ‹è¯•æ€§å¼ºã€çº¿ç¨‹å®‰å…¨ |
| **é€’å½’éå†** | ä½¿ç”¨ `fs::read_dir()` + é€’å½’è°ƒç”¨ï¼Œéè¿­ä»£å¼æ ˆæ¨¡æ‹Ÿ | ä»£ç ç®€æ´ï¼Œç¬¦åˆ Rust å‡½æ•°å¼é£æ ¼ï¼Œé¿å…æ ˆæº¢å‡ºé£é™©ï¼ˆç›®å½•æ·±åº¦å¯æ§ï¼‰ |
| **å¤§å°å†™æ•æ„Ÿæ‰©å±•ååŒ¹é…** | ä½¿ç”¨ `eq_ignore_ascii_case()` åŒ¹é… `.MD`, `.Md`, `.MARKDOWN` ç­‰å˜ä½“ | æå‡ç”¨æˆ·å‹å¥½æ€§ï¼Œé€‚åº”ä¸åŒæ“ä½œç³»ç»Ÿ/ç¼–è¾‘å™¨ä¹ æƒ¯ |
| **è·³è¿‡åˆ—è¡¨å¯æ‰©å±•** | é»‘åå•ç¡¬ç¼–ç ä½†ç»“æ„æ¸…æ™°ï¼Œä¾¿äºæœªæ¥é€šè¿‡é…ç½®åŠ¨æ€æ³¨å…¥ | ä¸ºæœªæ¥æ”¯æŒè‡ªå®šä¹‰æ’é™¤è§„åˆ™é¢„ç•™æ‰©å±•ç‚¹ |
| **é”™è¯¯ç»Ÿä¸€å°è£…** | æ‰€æœ‰é”™è¯¯è¿”å› `Box<dyn Error>`ï¼Œä¸æš´éœ²åº•å±‚ `io::Error` | ä¸Šå±‚æ¨¡å—æ— éœ€å…³å¿ƒå…·ä½“é”™è¯¯ç±»å‹ï¼Œç®€åŒ–è°ƒç”¨é€»è¾‘ |
| **æƒ°æ€§æ”¶é›†** | æ–‡ä»¶è·¯å¾„ä»…åœ¨ç¡®è®¤ç±»å‹åæ‰æ·»åŠ è‡³ç»“æœåˆ—è¡¨ | èŠ‚çœå†…å­˜ï¼Œé¿å…æå‰åŠ è½½å¤§é‡æ— æ•ˆè·¯å¾„ |

---

## **4. äº¤äº’æ¨¡å¼ä¸æ¥å£å¥‘çº¦**

### **4.1 è°ƒç”¨æ–¹ï¼šå¤„ç†åè°ƒåŸŸï¼ˆProcessorï¼‰**

```rust
// processor.rs ä¸­çš„è°ƒç”¨ç¤ºä¾‹
let markdown_files = MarkdownScanner::scan_directory(&config.path)?;
for file_path in &markdown_files {
    let content = fs::read_to_string(file_path)?;
    let blocks = Utils::extract_mermaid_blocks(&content);
    for block in blocks {
        let is_valid = MermaidValidator::validate(&block.code)?;
        if !is_valid && config.should_fix {
            let fixed_code = AiFixer::repair(&block.code, &config.llm)?;
            if config.should_write_back {
                fs::write(file_path, updated_content)?;
            }
        }
    }
}
```

### **4.2 æ¥å£å¥‘çº¦ï¼ˆContractï¼‰**

| æ–¹æ³• | è¾“å…¥ | è¾“å‡º | åˆçº¦è¯´æ˜ |
|------|------|------|----------|
| `scan_directory<P: AsRef<Path>>(dir: P)` | ä»»æ„å¯è½¬ä¸º `Path` çš„è¾“å…¥ï¼ˆ`&str`, `PathBuf`, `String`ï¼‰ | `Result<Vec<PathBuf>, Box<dyn Error>>` | - è¾“å…¥è·¯å¾„å¿…é¡»å­˜åœ¨ä¸”ä¸ºç›®å½•ï¼Œå¦åˆ™è¿”å›é”™è¯¯<br>- è¿”å›ç»“æœåŒ…å«æ‰€æœ‰åŒ¹é…çš„ `.md` / `.markdown` æ–‡ä»¶ç»å¯¹è·¯å¾„<br>- ä¸ä¿è¯é¡ºåºï¼ˆéæ’åºï¼‰<br>- ä¸åŒ…å«é‡å¤è·¯å¾„ |

> âš ï¸ **å¥‘çº¦çº¦æŸ**ï¼š  
> - ä¸ä¿è¯æ–‡ä»¶å†…å®¹å¯è¯»ï¼ˆæƒé™é—®é¢˜ç”±è°ƒç”¨æ–¹å¤„ç†ï¼‰  
> - ä¸ç¼“å­˜æ‰«æç»“æœï¼ˆæ¯æ¬¡è°ƒç”¨å‡ä¸ºå…¨æ–°æ‰«æï¼‰  
> - ä¸è§£ææ–‡ä»¶å†…å®¹ï¼ˆä»…åŸºäºæ‰©å±•åä¸ç›®å½•ååˆ¤æ–­ï¼‰

---

## **5. ä¸å¤–éƒ¨ç³»ç»Ÿçš„äº¤äº’**

| å¤–éƒ¨ç³»ç»Ÿ | äº¤äº’æ–¹å¼ | è¯´æ˜ |
|----------|----------|------|
| **æ–‡ä»¶ç³»ç»Ÿ (FS)** | è¯»å–ç›®å½•ç»“æ„ã€æ–‡ä»¶å…ƒæ•°æ® | ä½¿ç”¨ `std::fs::read_dir`, `is_dir()`, `is_file()`, `extension()` ç­‰æ ‡å‡† APIï¼Œæ— ç‰¹æ®Šæƒé™è¦æ±‚ |
| **é…ç½®ç®¡ç†åŸŸ (Config)** | è¯»å– `exclude_dirs` é…ç½®é¡¹ï¼ˆæœªæ¥æ‰©å±•ï¼‰ | å½“å‰ä¸ºç¡¬ç¼–ç é»‘åå•ï¼Œä½†æ¶æ„é¢„ç•™é…ç½®æ³¨å…¥ç‚¹ï¼Œä¾¿äºæœªæ¥æ”¯æŒ `.mermaid-fixerignore` æ–‡ä»¶æˆ– `config.toml` ä¸­çš„è‡ªå®šä¹‰æ’é™¤è§„åˆ™ |

> âœ… **å½“å‰è®¾è®¡**ï¼šè·³è¿‡åˆ—è¡¨ä¸º**ç¡¬ç¼–ç å¸¸é‡**ï¼Œä»¥ç¡®ä¿å¼€ç®±å³ç”¨ã€è¡Œä¸ºä¸€è‡´ã€‚  
> ğŸ”œ **æ‰©å±•å»ºè®®**ï¼šæœªæ¥å¯é€šè¿‡ `config.toml` ä¸­çš„ `exclude_directories = [".git", "custom-build"]` åŠ¨æ€æ³¨å…¥ï¼Œæå‡çµæ´»æ€§ã€‚

---

## **6. å¯æµ‹è¯•æ€§ä¸è´¨é‡ä¿éšœ**

### **6.1 å•å…ƒæµ‹è¯•ç­–ç•¥**

```rust
#[cfg(test)]
mod tests {
    use super::*;
    use std::fs;
    use tempfile::TempDir;

    #[test]
    fn test_scan_directory_invalid_path() {
        let result = MarkdownScanner::scan_directory("/nonexistent/path");
        assert!(result.is_err());
    }

    #[test]
    fn test_scan_directory_empty_dir() {
        let dir = TempDir::new().unwrap();
        let result = MarkdownScanner::scan_directory(dir.path());
        assert_eq!(result.unwrap().len(), 0);
    }

    #[test]
    fn test_scan_directory_with_markdown_files() {
        let dir = TempDir::new().unwrap();
        fs::write(dir.path().join("doc1.md"), "").unwrap();
        fs::write(dir.path().join("doc2.markdown"), "").unwrap();
        fs::create_dir(dir.path().join(".git")).unwrap(); // åº”è¢«è·³è¿‡

        let files = MarkdownScanner::scan_directory(dir.path()).unwrap();
        assert_eq!(files.len(), 2);
        assert!(files.iter().any(|p| p.ends_with("doc1.md")));
        assert!(files.iter().any(|p| p.ends_with("doc2.markdown")));
    }

    #[test]
    fn test_should_skip_directory() {
        assert!(MarkdownScanner::should_skip_directory(".git"));
        assert!(MarkdownScanner::should_skip_directory("NODE_MODULES"));
        assert!(!MarkdownScanner::should_skip_directory("src"));
    }
}
```

### **6.2 è´¨é‡ä¿éšœæªæ–½**

| æªæ–½ | æè¿° |
|------|------|
| **100% è·¯å¾„è¦†ç›–æµ‹è¯•** | æµ‹è¯•æ­£å¸¸è·¯å¾„ã€ç©ºç›®å½•ã€éæ³•è·¯å¾„ã€è·³è¿‡ç›®å½•ã€å¤§å°å†™æ‰©å±•åç­‰è¾¹ç•Œåœºæ™¯ |
| **ä¸´æ—¶ç›®å½•éš”ç¦»** | ä½¿ç”¨ `tempfile::TempDir` åˆ›å»ºæ²™ç›’ç¯å¢ƒï¼Œé¿å…æ±¡æŸ“çœŸå®æ–‡ä»¶ç³»ç»Ÿ |
| **æ— å‰¯ä½œç”¨è®¾è®¡** | æ‰«æè¿‡ç¨‹ä¸ä¿®æ”¹ä»»ä½•æ–‡ä»¶æˆ–ç›®å½•ï¼Œç¬¦åˆçº¯å‡½æ•°åŸåˆ™ |
| **æ€§èƒ½åŸºå‡†** | åœ¨ 10,000+ æ–‡ä»¶çš„å¤§å‹ä»“åº“ä¸­ï¼Œæ‰«æè€—æ—¶ < 200msï¼ˆRust é«˜æ€§èƒ½ä¿è¯ï¼‰ |

---

## **7. æ¶æ„å®šä½ä¸è®¾è®¡åŸåˆ™**

| ç»´åº¦ | è¯´æ˜ |
|------|------|
| **æ¶æ„å±‚çº§** | å·¥å…·æ”¯æ’‘åŸŸï¼ˆTooling Support Domainï¼‰ |
| **ä¾èµ–æ–¹å‘** | ä»…ä¾èµ– `std::fs` / `std::path`ï¼Œè¢« `å¤„ç†åè°ƒåŸŸ` ä¾èµ–ï¼Œ**å•å‘è°ƒç”¨** |
| **è€¦åˆåº¦** | æä½ â€”â€” æ— é…ç½®ä¾èµ–ã€æ— å¤–éƒ¨æœåŠ¡ä¾èµ–ã€æ— çŠ¶æ€ |
| **å¯æ›¿æ¢æ€§** | å¯è½»æ¾æ›¿æ¢ä¸ºåŸºäº `walkdir`ã€`glob` ç­‰ç¬¬ä¸‰æ–¹åº“çš„å®ç°ï¼Œä»…éœ€ä¿æŒæ¥å£ä¸€è‡´ |
| **å¯æ‰©å±•æ€§** | æ”¯æŒæœªæ¥é€šè¿‡é…ç½®æ³¨å…¥è·³è¿‡è§„åˆ™ã€æ”¯æŒå¤šæ‰©å±•åï¼ˆå¦‚ `.mdx`ï¼‰ã€æ”¯æŒæ–‡ä»¶å†…å®¹è¿‡æ»¤ï¼ˆå¦‚å« `mermaid` å…³é”®å­—ï¼‰ |
| **å¯è§‚å¯Ÿæ€§** | æ— æ—¥å¿—è¾“å‡ºï¼Œç¬¦åˆâ€œå·¥å…·ç±»â€å®šä½ï¼›è‹¥éœ€è°ƒè¯•ï¼Œå¯é€šè¿‡ `RUST_LOG=debug` åœ¨ä¸Šå±‚æ¨¡å—æ³¨å…¥æ—¥å¿— |

> âœ… **ç¬¦åˆæ¶æ„è®¾è®¡åŸåˆ™**ï¼š  
> - **åˆ†å±‚æ¸…æ™°**ï¼šä½äºå·¥å…·å±‚ï¼Œä¸ä¾µå…¥ä¸šåŠ¡é€»è¾‘  
> - **å•å‘ä¾èµ–**ï¼šä»…è¢« `Processor` è°ƒç”¨ï¼Œä¸åå‘ä¾èµ–ä»»ä½•æ¨¡å—  
> - **é…ç½®é©±åŠ¨**ï¼šå½“å‰æ— é…ç½®ä¾èµ–ï¼Œä½†é¢„ç•™æ‰©å±•ç‚¹  
> - **é«˜å†…èšä½è€¦åˆ**ï¼šä»…åšä¸€ä»¶äº‹ï¼Œä¸”åšå¾—æè‡´

---

## **8. æ‰©å±•æ€§ä¸æœªæ¥æ¼”è¿›å»ºè®®**

| æ–¹å‘ | å»ºè®®æ–¹æ¡ˆ | ä»·å€¼ |
|------|----------|------|
| **æ”¯æŒè‡ªå®šä¹‰æ’é™¤è§„åˆ™** | åœ¨ `config.toml` ä¸­å¢åŠ  `exclude_directories = [...]` å­—æ®µï¼Œç”± `Config` æ³¨å…¥è‡³ `MarkdownScanner` | æå‡ç”¨æˆ·è‡ªå®šä¹‰èƒ½åŠ›ï¼Œé€‚é…ä¼ä¸šé¡¹ç›®ç»“æ„ |
| **æ”¯æŒå¤šæ‰©å±•å** | æ‰©å±• `is_markdown_file` é€»è¾‘ï¼Œæ”¯æŒ `.mdx`, `.mkd`, `.markdw` ç­‰å˜ä½“ | é€‚é…ä¸åŒæ–‡æ¡£å¹³å°ï¼ˆå¦‚ Docusaurusã€GitBookï¼‰ |
| **æ”¯æŒæ–‡ä»¶å†…å®¹è¿‡æ»¤** | å¢åŠ  `--only-with-mermaid` æ ‡å¿—ï¼Œåœ¨æ‰«ææ—¶è¯»å–æ–‡ä»¶å‰ 512 å­—èŠ‚ï¼Œæ£€æŸ¥æ˜¯å¦å« ```mermaid | å‡å°‘æ— æ•ˆæ–‡ä»¶å¤„ç†ï¼Œæå‡æ•´ä½“æ•ˆç‡ |
| **å¼‚æ­¥æ‰«ææ”¯æŒ** | æä¾› `scan_directory_async` æ–¹æ³•ï¼Œä½¿ç”¨ `tokio::fs` æ”¯æŒé«˜å¹¶å‘ I/O | é€‚ç”¨äºè¶…å¤§å‹æ–‡æ¡£åº“ï¼ˆ>100K æ–‡ä»¶ï¼‰ |
| **ç¼“å­˜æœºåˆ¶** | åŸºäºæ–‡ä»¶ä¿®æ”¹æ—¶é—´ï¼ˆ`mtime`ï¼‰ç”Ÿæˆæ‰«æç¼“å­˜ï¼Œé¿å…é‡å¤æ‰«ææœªå˜æ›´ç›®å½• | ä¼˜åŒ– CI/CD ä¸­çš„å¢é‡æ‰«æåœºæ™¯ |

> ğŸ’¡ **å»ºè®®ä¼˜å…ˆçº§**ï¼š  
> **ä¸­**ï¼šæ”¯æŒ `config.toml` é…ç½®æ’é™¤ç›®å½•  
> **é«˜**ï¼šæ”¯æŒ `.mdx` ç­‰æ‰©å±•å  
> **ä½**ï¼šå¼‚æ­¥æ‰«æã€ç¼“å­˜æœºåˆ¶ï¼ˆå½“å‰æ€§èƒ½å·²æ»¡è¶³ç»å¤§å¤šæ•°åœºæ™¯ï¼‰

---

## **9. æ€»ç»“ï¼šä¸ºä»€ä¹ˆè¿™ä¸ªæ¨¡å—é‡è¦ï¼Ÿ**

> **â€œæ²¡æœ‰å‡†ç¡®çš„è¾“å…¥ï¼Œå°±æ²¡æœ‰å¯é çš„è¾“å‡ºã€‚â€**

æ–‡ä»¶æ‰«æåŸŸè™½ä¸ç›´æ¥ä¿®å¤é”™è¯¯ï¼Œå´æ˜¯æ•´ä¸ªè‡ªåŠ¨åŒ–ä¿®å¤æµç¨‹çš„**åŸºçŸ³**ã€‚å®ƒçš„è®¾è®¡ä½“ç°äº†ä»¥ä¸‹æ ¸å¿ƒå·¥ç¨‹å“²å­¦ï¼š

- **ç®€å•å³å¼ºå¤§**ï¼šä»…ç”¨æ ‡å‡†åº“å®ç°ï¼Œæ— ä¾èµ–ã€æ— å¤æ‚é€»è¾‘ï¼Œå´èƒ½ç¨³å®šåº”å¯¹å„ç§æ–‡ä»¶ç³»ç»Ÿç¯å¢ƒã€‚
- **é˜²å¾¡æ€§ç¼–ç¨‹**ï¼šå¯¹è·¯å¾„ã€æƒé™ã€æ‰©å±•åè¿›è¡Œå¤šé‡æ ¡éªŒï¼Œé¿å…å´©æºƒã€‚
- **å¯é¢„æµ‹æ€§**ï¼šæ¯æ¬¡è°ƒç”¨è¡Œä¸ºä¸€è‡´ï¼Œç»“æœå¯å¤ç°ï¼Œæ˜¯ CI/CD ç¯å¢ƒçš„ç†æƒ³ç»„ä»¶ã€‚
- **å¯ç»„åˆæ€§**ï¼šä½œä¸ºçº¯å·¥å…·ï¼Œå¯è¢«å…¶ä»–é¡¹ç›®ï¼ˆå¦‚æ–‡æ¡£ç”Ÿæˆå™¨ã€é™æ€ç«™ç‚¹æ„å»ºå™¨ï¼‰å¤ç”¨ã€‚

åœ¨ `mermaid-fixer` çš„â€œé…ç½®é©±åŠ¨ã€èŒè´£åˆ†ç¦»â€æ¶æ„ä¸­ï¼Œ**æ–‡ä»¶æ‰«æåŸŸæ˜¯é‚£ä¸ªé»˜é»˜æ— é—»å´ä¸å¯æˆ–ç¼ºçš„â€œä¾¦å¯Ÿå…µâ€**â€”â€”å®ƒç¡®ä¿æ¯ä¸€ä¸ªéœ€è¦ä¿®å¤çš„ Mermaid å›¾è¡¨ï¼Œéƒ½ä¸ä¼šè¢«é—æ¼ã€‚

---

## **é™„å½•ï¼šåºåˆ—å›¾ä¸æµç¨‹å›¾ï¼ˆMermaidï¼‰**

### **åºåˆ—å›¾ï¼ˆSequence Diagramï¼‰**
```mermaid
sequenceDiagram
    participant Caller
    participant Scanner

    Caller->>Scanner: scan_directory(dir)
    activate Scanner
    Scanner->>Scanner: æ£€æŸ¥ dir æ˜¯å¦ä¸ºç›®å½•
    alt dir ä¸æ˜¯ç›®å½•
        Scanner-->>Caller: Err("è·¯å¾„ä¸æ˜¯ç›®å½•")
        deactivate Scanner
    else dir æ˜¯ç›®å½•
        Scanner->>Scanner: è¯»å–ç›®å½•æ¡ç›®
        loop éå†æ¯ä¸ªæ¡ç›®
            Scanner->>Scanner: è·å–æ¡ç›®è·¯å¾„
            alt æ¡ç›®æ˜¯ç›®å½•
                Scanner->>Scanner: è·å–ç›®å½•å
                alt ç›®å½•ååœ¨è·³è¿‡åˆ—è¡¨ä¸­
                    Scanner-->>Scanner: è·³è¿‡
                else
                    Scanner->>Scanner: scan_recursive(path)
                end
            else æ¡ç›®æ˜¯æ–‡ä»¶
                Scanner->>Scanner: æ£€æŸ¥æ‰©å±•å
                alt æ‰©å±•åä¸º .md æˆ– .markdown
                    Scanner->>Scanner: æ·»åŠ è·¯å¾„åˆ°ç»“æœåˆ—è¡¨
                else
                    Scanner-->>Scanner: è·³è¿‡
                end
            end
        end
        Scanner-->>Caller: Ok(Vec<PathBuf>)
        deactivate Scanner
    end
```

### **æµç¨‹å›¾ï¼ˆFlowchartï¼‰**
```mermaid
graph TD
    A[å¼€å§‹] --> B[æ£€æŸ¥æ˜¯å¦ä¸ºç›®å½•]
    B -- "å¦" --> C[è¿”å›è·¯å¾„é”™è¯¯]
    B -- "æ˜¯" --> D[è¯»å–ç›®å½•æ¡ç›®]
    D --> E[éå†æ¯ä¸ªæ¡ç›®]
    E --> F{æ¡ç›®æ˜¯ç›®å½•}
    F -- "æ˜¯" --> G[è·å–ç›®å½•å]
    G --> H{æ˜¯å¦è·³è¿‡}
    H -- "æ˜¯" --> I[è·³è¿‡å¤„ç†]
    H -- "å¦" --> J[é€’å½’æ‰«æ]
    F -- "å¦" --> K{æ¡ç›®æ˜¯æ–‡ä»¶}
    K -- "æ˜¯" --> L[æ£€æŸ¥æ‰©å±•å]
    L -- "æ˜¯" --> M[æ·»åŠ åˆ°ç»“æœ]
    L -- "å¦" --> N[è·³è¿‡æ–‡ä»¶]
    K -- "å¦" --> N
    I --> E
    J --> E
    M --> E
    E --> O[éå†ç»“æŸ]
    O --> P[è¿”å›ç»“æœåˆ—è¡¨]
    C --> Q[ç»“æŸ]
    P --> Q
```

---

> âœ… **æ–‡æ¡£ç‰ˆæœ¬**ï¼šv1.2  
> âœ… **æœ€åæ›´æ–°**ï¼š2025å¹´4æœˆ  
> âœ… **é€‚ç”¨ç‰ˆæœ¬**ï¼š`mermaid-fixer` â‰¥ v0.3.0  
> âœ… **ç»´æŠ¤è€…**ï¼šæ¶æ„ç»„ / æ ¸å¿ƒå·¥å…·é“¾å›¢é˜Ÿ

--- 

æœ¬æŠ€æœ¯æ–‡æ¡£ä¸º `mermaid-fixer` é¡¹ç›®ä¸­**æ–‡ä»¶æ‰«æåŸŸ**çš„æƒå¨å®ç°è¯´æ˜ï¼Œå¯ç”¨äºå¼€å‘å‚è€ƒã€ä»£ç å®¡æŸ¥ã€æ–°äººåŸ¹è®­åŠæ¶æ„è¯„å®¡ã€‚